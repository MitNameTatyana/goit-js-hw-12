{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport async function getImages(query, currentPage) {\n  const params = {\n    key: '44649525-fae4a92093e5fa87b7d67167e',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  };\n\n  const res = await axios.get('/api/', { params });\n  return res.data;\n}\n","export function createGalleryMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n  </a>\n  <ul class=\"list-img\">\n    <li class=\"item-img\">\n      <span class=\"label\">Likes</span>\n      <span class=\"value\">${likes}</span>\n    </li>\n    <li class=\"item-img\">\n      <span class=\"label\">Views</span>\n      <span class=\"value\">${views}</span>\n    </li>\n    <li class=\"item-img\">\n      <span class=\"label\">Comments</span>\n      <span class=\"value\">${comments}</span>\n    </li>\n    <li class=\"item-img\">\n      <span class=\"label\">Downloads</span>\n      <span class=\"value\">${downloads}</span>\n    </li>\n  </ul>\n</li>`;\n      }\n    )\n    .join('');\n}\n","import { getImages } from './js/pixabay-api';\nimport { createGalleryMarkup } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  btnLoadMore: document.querySelector('.load-more-button'),\n  loader: document.querySelector('.loader'),\n};\n\nlet searchQuery = '';\nlet currentPage = 1;\nlet maxPage = 1;\nconst perPages = 15;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nrefs.form.addEventListener('submit', onSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMore);\n\nasync function onSubmit(e) {\n  e.preventDefault();\n  refs.gallery.innerHTML = '';\n\n  searchQuery = e.target.elements['search-input'].value.trim().toLowerCase();\n\n  if (!searchQuery) {\n    showInfo('Please enter a search query');\n    return;\n  }\n\n  currentPage = 1;\n  hideBtnLoadMore();\n  showLoader();\n\n  try {\n    const data = await getImages(searchQuery, currentPage);\n    maxPage = Math.ceil(data.totalHits / perPages);\n\n    if (maxPage === 0) {\n      showNotFound(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      hideLoader();\n      e.target.reset();\n      return;\n    }\n\n    const markup = createGalleryMarkup(data.hits);\n    refs.gallery.innerHTML = markup;\n    lightbox.refresh();\n  } catch {\n    error => {\n      showError(error);\n    };\n  }\n\n  hideLoader();\n  updateBtnStatus();\n  e.target.reset();\n}\n\nasync function onLoadMore(e) {\n  e.preventDefault();\n\n  currentPage++;\n  hideBtnLoadMore();\n  showLoader();\n\n  try {\n    const data = await getImages(searchQuery, currentPage);\n    const markup = createGalleryMarkup(data.hits);\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n    skipOldElement();\n  } catch {\n    error => {\n      showError(error);\n    };\n  }\n\n  hideLoader();\n  updateBtnStatus();\n}\n\nfunction updateBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideBtnLoadMore();\n    if (maxPage) {\n      showNotFound(\"We're sorry, but you've reached the end of search results\");\n    }\n  } else {\n    showBtnLoadMore();\n  }\n}\n\nfunction skipOldElement() {\n  const liElem = refs.gallery.children[0];\n  const height = liElem.getBoundingClientRect().height;\n\n  scrollBy({\n    top: height * 3,\n    behavior: 'smooth',\n  });\n}\n\nfunction showBtnLoadMore() {\n  refs.btnLoadMore.classList.remove('hidden');\n}\nfunction hideBtnLoadMore() {\n  refs.btnLoadMore.classList.add('hidden');\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('hidden');\n}\nfunction hideLoader() {\n  refs.loader.classList.add('hidden');\n}\n\nconst iziToastConfig = {\n  position: 'center',\n  backgroundColor: 'rgb(78, 117, 255)',\n  theme: 'dark',\n  messageSize: '16',\n  messageColor: 'white',\n  messageLineHeight: '1,5',\n  progressBar: false,\n  pauseOnHover: true,\n  timeout: 3000,\n};\n\nfunction showInfo(message) {\n  iziToast.info({\n    message,\n    ...iziToastConfig,\n  });\n}\nfunction showNotFound(message) {\n  iziToast.error({\n    message,\n    maxWidth: '432',\n    ...iziToastConfig,\n  });\n}\nfunction showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message,\n    maxWidth: '432',\n    position: 'center',\n    backgroundColor: 'red',\n    messageSize: '16',\n    messageLineHeight: '1,5',\n    progressBar: false,\n    pauseOnHover: true,\n  });\n}\n"],"names":["axios","getImages","query","currentPage","params","createGalleryMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","searchQuery","maxPage","perPages","lightbox","SimpleLightbox","onSubmit","onLoadMore","e","showInfo","hideBtnLoadMore","showLoader","data","showNotFound","hideLoader","markup","updateBtnStatus","skipOldElement","showBtnLoadMore","height","iziToastConfig","message","iziToast"],"mappings":"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"}